<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>LHTML</title>
    <style>
    body {
      margin: 0;
      padding: 0;
    }
    </style>
  </head>
  <body>
    <webview id="theview" autosize="on" minwidth="400" minheight="400" style="width: 100vw; height: 100vh;" preload="./guest-preload.js"></webview>
<script>
const {ipcRenderer} = require('electron');

onload = () => {
  const webview = document.getElementById('theview');
  const loadstart = () => {
    console.log('loading');
  }
  const loadstop = () => {
    console.log('load stop');
    document.title = webview.getTitle();
  }
  webview.addEventListener('did-start-loading', loadstart);
  webview.addEventListener('did-stop-loading', loadstop);

  // Handle main -> guest communication
  ipcRenderer.on('rpc', (event, message) => {
    console.log('rpc passthru', message);
    webview.send('rpc', message);
  })

  // Toggle Dev Tools
  ipcRenderer.on('toggleDevTools', (event) => {
    webview.getWebContents().toggleDevTools();
  })

  // Open...
  ipcRenderer.on('load-file', (event, url) => {
    console.log('load file', url);
    webview.src = url;
  })

  // Reload...
  ipcRenderer.on('reload-file', (event) => {
    console.log('reload-file');
    webview.reload();
  });

  webview.addEventListener('ipc-message', (event) => {
    console.log('got event', event);
  });
}
</script>
  </body>
</html>