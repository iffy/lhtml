Added safeguards to make sure the document and main process aren't trying to write/save at the same time
